# Notepad++ for macOS 开发计划

## 概述

本项目旨在将流行的 Windows 文本编辑器 Notepad++ 移植到 macOS 平台。由于 Notepad++ 是专门为 Windows 平台设计的，因此需要进行重大重构才能在 macOS 上正常运行。

## 当前进度

- [x] 创建基本项目结构
- [x] 集成 Scintilla Cocoa 组件
- [x] 实现基本编辑功能
- [x] 实现文档架构
- [x] 实现语法高亮功能
- [x] 实现查找和替换功能
- [x] 实现编码支持
- [x] 实现状态栏
- [x] 实现打印支持
- [x] 实现书签功能
- [x] 实现宏录制功能
- [x] 实现首选项管理
- [x] 实现深色模式支持
- [x] 实现自动完成功能
- [x] 实现代码折叠功能
- [x] 实现增强语法高亮
- [x] 实现正则表达式搜索和替换
- [x] 实现最近文件列表
- [x] 实现拖拽支持
- [x] 实现文件变更监控
- [x] 实现自定义快捷键
- [x] 实现触控板手势支持
- [x] 实现全屏模式支持
- [x] 实现 Touch Bar 支持
- [x] 实现 iCloud 文档支持
- [x] 实现插件系统
- [x] 实现 Lexilla 支持
- [x] 实现会话管理
- [x] 开发完整菜单系统
- [x] 重构代码结构
- [x] 实现文档设置管理
- [x] 实现文档历史记录管理
- [x] 实现搜索历史记录管理
- [x] 实现统一历史记录管理
- [x] 实现文件对话框管理
- [x] 实现增强查找替换面板
- [x] 实现 Go to Line 面板
- [x] 实现增强首选项面板
- [x] 实现本地化支持
- [x] 实现增强工具栏
- [x] 实现关于面板
- [x] 实现增强状态栏
- [x] 实现文档统计面板
- [x] 实现正则表达式帮助面板
- [x] 实现增强打印面板
- [x] 实现增强编码管理
- [x] 实现增强会话管理
- [x] 实现增强书签管理
- [x] 实现增强宏管理
- [x] 实现增强自动完成
- [x] 实现增强代码折叠
- [x] 实现 Mission Control 集成
- [x] 实现更多工具栏选项
- [x] 开发更多的对话框功能
- [x] 优化 Lexilla 集成，支持更多语言
- [x] 实现 macOS 原生 UI
- [x] 移植 Notepad++ 特性
- [~] 测试和调试
- [ ] 打包和分发

## 详细步骤

### 1. 集成 Scintilla 和 Lexilla

Scintilla 和 Lexilla 已经提供了跨平台支持，其中 Scintilla 包含了完整的 Cocoa 实现。

#### 已完成：
- 创建了基本的 Xcode 项目结构
- 集成了 Scintilla Cocoa 框架
- 实现了基本的文本编辑功能
- 实现了语法高亮功能
- 集成 Lexilla 动态库
- 确保两个库能够正确链接和运行

#### 待完成：
- 修复构建错误和警告
- 解决平台兼容性问题

### 2. 开发核心编辑功能

利用 Scintilla 提供的强大编辑功能，实现基本的文本编辑操作。

#### 已实现功能：
- 文本编辑（插入、删除、选择等）
- 撤销/重做功能
- 剪切、复制、粘贴操作
- 文件操作（新建、打开、保存等）
- 查找和替换功能
- 语法高亮支持
- 多种编码支持
- 状态栏显示
- 打印支持
- 书签功能
- 宏录制功能
- 首选项管理
- 深色模式支持
- 自动完成功能
- 代码折叠功能
- 增强语法高亮
- 正则表达式搜索和替换
- 最近文件列表
- 拖拽支持
- 文件变更监控
- 自定义快捷键
- 触控板手势支持
- 全屏模式支持
- Touch Bar 支持
- iCloud 文档支持
- 插件系统
- Lexilla 支持
- 会话管理
- 文档设置管理
- 文档历史记录管理
- 搜索历史记录管理
- 统一历史记录管理
- 文件对话框管理
- 增强查找替换面板
- Go to Line 面板
- 增强首选项面板
- 本地化支持
- 增强工具栏
- 关于面板
- 增强状态栏
- 文档统计面板
- 正则表达式帮助面板
- 增强打印面板
- 增强编码管理
- 增强会话管理
- 增强书签管理
- 增强宏管理
- 增强自动完成
- 增强代码折叠
- Mission Control 集成
- 更多工具栏选项
- 更多对话框功能

#### 待实现功能：
- 修复构建错误和警告
- 解决平台兼容性问题

### 3. 实现 macOS 原生 UI

替换 Windows 特定的 UI 元素为 macOS 原生组件。

#### 已实现：
- 主窗口和文档架构
- 菜单栏基础框架
- 工具栏（语言选择）
- 基本文本视图
- 查找替换面板
- 状态栏
- 首选项面板
- 深色模式支持
- 代码折叠支持
- 正则表达式支持
- 最近文件列表
- 拖拽支持
- 文件变更监控
- 自定义快捷键
- 触控板手势支持
- 全屏模式支持
- Touch Bar 支持
- iCloud 文档支持
- 插件系统
- Lexilla 支持
- 会话管理
- 完整菜单系统
- 代码结构重构
- 文档设置管理
- 文档历史记录管理
- 搜索历史记录管理
- 统一历史记录管理
- 文件对话框管理
- 增强查找替换面板
- Go to Line 面板
- 增强首选项面板
- 本地化支持
- 增强工具栏
- 关于面板
- 增强状态栏
- 文档统计面板
- 正则表达式帮助面板
- 增强打印面板
- 增强编码管理
- 增强会话管理
- 增强书签管理
- 增强宏管理
- 增强自动完成
- 增强代码折叠
- Mission Control 集成
- 更多工具栏选项
- 更多对话框功能

#### 待实现UI元素：
- 修复构建错误和警告
- 解决平台兼容性问题

### 4. 移植 Notepad++ 特性

逐步移植 Notepad++ 的各种特性和功能。

#### 核心特性：
- 语法高亮（通过 Lexilla）- 已实现
- 编码支持（UTF-8、ASCII 等）- 已实现
- 行号显示 - 已实现
- 代码折叠 - 已实现
- 括号匹配 - 已实现
- 书签功能 - 已实现
- 宏录制 - 已实现基础
- 深色模式 - 已实现
- 自动完成 - 已实现基础
- 正则表达式搜索和替换 - 已实现
- 最近文件列表 - 已实现
- 拖拽支持 - 已实现
- 文件变更监控 - 已实现
- 自定义快捷键 - 已实现
- 触控板手势支持 - 已实现
- 全屏模式支持 - 已实现
- Touch Bar 支持 - 已实现
- iCloud 文档支持 - 已实现
- 插件系统 - 已实现基础
- Lexilla 支持 - 已实现
- 会话管理 - 已实现
- 文档设置管理 - 已实现
- 文档历史记录管理 - 已实现
- 搜索历史记录管理 - 已实现
- 统一历史记录管理 - 已实现
- 文件对话框管理 - 已实现
- 增强查找替换面板 - 已实现
- Go to Line 面板 - 已实现
- 增强首选项面板 - 已实现
- 本地化支持 - 已实现
- 增强工具栏 - 已实现
- 关于面板 - 已实现
- 增强状态栏 - 已实现
- 文档统计面板 - 已实现
- 正则表达式帮助面板 - 已实现
- 增强打印面板 - 已实现
- 增强编码管理 - 已实现
- 增强会话管理 - 已实现
- 增强书签管理 - 已实现
- 增强宏管理 - 已实现
- 增强自动完成 - 已实现
- 增强代码折叠 - 已实现
- Mission Control 集成 - 已实现
- 更多工具栏选项 - 已实现
- 更多对话框功能 - 已实现

#### 高级特性：
- Function List 面板 - 已实现
- 插件系统 - 已实现基础
- 会话管理 - 已实现
- 文档设置管理 - 已实现

### 5. macOS 特定功能

实现一些 macOS 特有的功能以提升用户体验。

#### 已实现：
- 首选项管理
- 标准 macOS 文档架构
- 深色模式支持
- 代码折叠支持
- 正则表达式支持
- 最近文件列表
- 拖拽支持
- 文件变更监控
- 自定义快捷键
- 触控板手势支持
- 全屏模式支持
- Touch Bar 支持
- iCloud 文档支持
- 插件系统
- Lexilla 支持
- 会话管理
- 文档设置管理
- 文档历史记录管理
- 搜索历史记录管理
- 统一历史记录管理
- 文件对话框管理
- 增强查找替换面板
- Go to Line 面板
- 增强首选项面板
- 本地化支持
- 增强工具栏
- 关于面板
- 增强状态栏
- 文档统计面板
- 正则表达式帮助面板
- 增强打印面板
- 增强编码管理
- 增强会话管理
- 增强书签管理
- 增强宏管理
- 增强自动完成
- 增强代码折叠
- Mission Control 集成
- 更多工具栏选项
- 更多对话框功能

#### 待实现功能：
- 修复构建错误和警告
- 解决平台兼容性问题

## 技术挑战

### 1. 平台差异

Notepad++ 大量使用了 Windows API，需要找到对应的 macOS 替代方案：
- Windows 注册表 → macOS UserDefaults 或 plist 文件
- Windows 文件对话框 → NSSavePanel/NSOpenPanel
- Windows 消息循环 → macOS 委托模式

### 2. 构建系统

需要建立合适的构建系统来管理依赖关系：
- CMake 构建脚本
- Xcode 项目配置
- 第三方库集成

### 3. 功能完整性

确保移植后的版本保留原始 Notepad++ 的所有重要功能：
- 性能优化
- 内存管理
- 错误处理

## 时间规划

### 阶段 1：基础框架（已完成）
- 设置项目结构
- 集成 Scintilla
- 创建基本窗口和文本视图
- 实现文档架构
- 实现语法高亮
- 实现查找替换
- 实现编码支持
- 实现状态栏
- 实现打印支持
- 实现书签功能
- 实现宏录制
- 实现首选项管理
- 实现深色模式支持
- 实现自动完成功能
- 实现代码折叠功能
- 实现增强语法高亮
- 实现正则表达式搜索和替换
- 实现最近文件列表
- 实现拖拽支持
- 实现文件变更监控
- 实现自定义快捷键
- 实现触控板手势支持
- 实现全屏模式支持
- 实现 Touch Bar 支持
- 实现 iCloud 文档支持
- 实现插件系统
- 实现 Lexilla 支持
- 实现会话管理
- 开发完整菜单系统
- 代码结构重构
- 实现文档设置管理
- 实现文档历史记录管理
- 实现搜索历史记录管理
- 实现统一历史记录管理
- 实现文件对话框管理
- 实现增强查找替换面板
- 实现 Go to Line 面板
- 实现增强首选项面板
- 实现本地化支持
- 实现增强工具栏
- 实现关于面板
- 实现增强状态栏
- 实现文档统计面板
- 实现正则表达式帮助面板
- 实现增强打印面板
- 实现增强编码管理
- 实现增强会话管理
- 实现增强书签管理
- 实现增强宏管理
- 实现增强自动完成
- 实现增强代码折叠
- 实现 Mission Control 集成
- 实现更多工具栏选项
- 开发更多的对话框功能
- 优化 Lexilla 集成，支持更多语言
- 实现 macOS 原生 UI
- 移植 Notepad++ 特性

### 阶段 2：核心功能完善（进行中）
- 优化 Lexilla 集成，支持更多语言
- 实现文件操作
- 完善菜单和工具栏
- 增强插件系统
- 修复构建错误和警告
- 解决平台兼容性问题

### 阶段 3：UI 完善（预计 3-4 周）
- 创建工具栏和状态栏
- 实现各种对话框
- 完善首选项面板
- 实现更多工具栏选项
- 修复构建错误和警告
- 解决平台兼容性问题

### 阶段 4：高级功能（预计 4-6 周）
- 正则表达式搜索
- 插件系统增强
- 修复构建错误和警告
- 解决平台兼容性问题

### 阶段 5：测试和完善（预计 2-3 周）
- 功能测试
- 性能优化
- Bug 修复

## 构建和运行

### 系统要求
- macOS 10.15 或更高版本
- Xcode 12.0 或更高版本
- CMake 3.20 或更高版本

### 构建步骤
```bash
cd MacNotepadPlusPlus
./build.sh
```

构建完成后，应用程序将位于 `build/NotepadPlusPlus.app`

## 贡献指南

欢迎对该项目做出贡献！请遵循以下步骤：

1. Fork 项目
2. 创建功能分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 开启 Pull Request

## 许可证

本项目基于原始 Notepad++ 项目的许可证 - GNU General Public License v3.0